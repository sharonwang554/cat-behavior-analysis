{% extends "base.html" %} {% block content %}
<div class="card">
  <h2>üìä Detailed Analysis Results</h2>
  <a href="/" class="btn">‚Üê Back to Dashboard</a>
</div>

{% if results %}
<div class="card">
  <div
    class="download-section"
    style="background: #d4edda; border: 1px solid #c3e6cb"
  >
    <h3 style="color: #155724">üéØ Professional Analysis Report</h3>
    <p style="color: #155724; font-size: 16px; margin-bottom: 20px">
      <strong>Get the complete picture:</strong> Download a comprehensive text
      report that includes:
    </p>
    <ul
      style="
        text-align: left;
        color: #155724;
        margin: 15px 0;
        padding-left: 30px;
      "
    >
      <li>
        <strong>Executive Summary:</strong> Overall behavioral patterns across
        all videos
      </li>
      <li>
        <strong>Individual Video Analysis:</strong> Detailed breakdown for each
        video
      </li>
      <li>
        <strong>Behavioral Insights:</strong> Professional recommendations for
        cat care
      </li>
      <li>
        <strong>Confidence Scoring:</strong> Reliability indicators for all
        analyses
      </li>
      <li>
        <strong>Methodology Notes:</strong> Explanation of analysis techniques
        used
      </li>
    </ul>
    <a
      href="/download_report"
      class="btn btn-warning"
      style="font-size: 18px; padding: 15px 30px; font-weight: bold"
    >
      üìÑ Download Complete Analysis Report (TXT)
    </a>
  </div>
</div>
{% endif %} {% for video_name, result in results.items() %}
<div class="card">
  <h2>üìπ {{ video_name }}</h2>

  <div
    style="
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-top: 20px;
    "
  >
    <!-- Audio Analysis -->
    <div>
      <h3>üéµ Audio Analysis</h3>
      <div class="result-item">
        <span class="result-label">Primary Meaning:</span>
        {{ result['audio_analysis']['primary_meaning'] or 'Not determined' }}
      </div>
      <div class="result-item">
        <span class="result-label">Emotional State:</span>
        <span class="status-badge" id="emotion-badge-{{ loop.index0 }}">
          {{ result['audio_analysis']['emotional_state'] }}
        </span>
        <script>
          document.getElementById('emotion-badge-{{ loop.index0 }}').className += ' ' + getEmotionalStateClass('{{ result['audio_analysis']['emotional_state'] }}');
        </script>
      </div>
      <div class="result-item">
        <span class="result-label">Urgency Level:</span>
        <span class="status-badge" id="urgency-badge-{{ loop.index0 }}">
          {{ result['audio_analysis']['urgency_level'] }}
        </span>
        <script>
          document.getElementById('urgency-badge-{{ loop.index0 }}').className += ' ' + getUrgencyClass('{{ result['audio_analysis']['urgency_level'] }}');
        </script>
      </div>
      <div class="result-item">
        <span class="result-label">Analysis Confidence:</span>
        <span class="status-badge" id="confidence-badge-{{ loop.index0 }}">
          {{ result['audio_analysis']['confidence'] }}
        </span>
        <script>
          document.getElementById('confidence-badge-{{ loop.index0 }}').className += ' ' + getConfidenceClass('{{ result['audio_analysis']['confidence'] }}');
        </script>
      </div>
    </div>

    <!-- Video Analysis -->
    <div>
      <h3>üé• Video Analysis</h3>
      <div class="result-item">
        <span class="result-label">Duration:</span>
        {{ "%.1f"|format(result['visual_analysis']['duration']) }} seconds
      </div>
      <div class="result-item">
        <span class="result-label">Activity Level:</span>
        <span class="status-badge" id="activity-badge-{{ loop.index0 }}">
          {{ result['visual_analysis']['dominant_activity'] }}
        </span>
        <script>
          document.getElementById('activity-badge-{{ loop.index0 }}').className += ' ' + getActivityClass('{{ result['visual_analysis']['dominant_activity'] }}');
        </script>
      </div>
      <div class="result-item">
        <span class="result-label">Avg Movement:</span>
        {{ "%.1f"|format(result['visual_analysis']['avg_movement']) }}
      </div>
      <div class="result-item">
        <span class="result-label">Avg Brightness:</span>
        {{ "%.1f"|format(result['visual_analysis']['avg_brightness']) }}
      </div>
    </div>
  </div>

  <!-- Combined Interpretation -->
  <div style="margin-top: 30px">
    <h3>üß† Combined Behavioral Analysis</h3>
    <div class="result-item">
      <span class="result-label">Overall Mood:</span>
      {{ result['combined_interpretation']['overall_mood'] }}
    </div>
    <div class="result-item">
      <span class="result-label">Behavior Pattern:</span>
      {{ result['combined_interpretation']['behavior_pattern'] }}
    </div>
    <div class="result-item">
      <span class="result-label">Analysis Confidence:</span>
      <span
        class="status-badge"
        id="combined-confidence-badge-{{ loop.index0 }}"
      >
        {{ result['combined_interpretation']['confidence'] }}
      </span>
      <script>
        document.getElementById('combined-confidence-badge-{{ loop.index0 }}').className += ' ' + getConfidenceClass('{{ result['combined_interpretation']['confidence'] }}');
      </script>
    </div>

    {% if result['combined_interpretation']['recommendations'] %}
    <div style="margin-top: 20px">
      <h4>üí° Recommendations:</h4>
      <ul style="margin: 10px 0; padding-left: 30px">
        {% for rec in result['combined_interpretation']['recommendations'] %}
        <li>{{ rec }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>

  <!-- Download Individual Files -->
  <div class="download-section">
    <h3>üì• Download Files for {{ video_name }}</h3>
    <div
      style="
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
      "
    >
      <button
        class="btn"
        onclick="downloadFile('video_analysis_results/{{ video_name }}_visual_analysis.png')"
      >
        üìä Visual Analysis Graph
      </button>
      <button
        class="btn"
        onclick="downloadFile('combined_analysis_results/{{ video_name }}_combined_analysis.json')"
      >
        üìã Complete Analysis Data
      </button>
    </div>
  </div>

  <!-- Analysis Timestamp -->
  <div
    style="
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #eee;
      color: #666;
      font-size: 0.9em;
    "
  >
    <strong>Analysis completed:</strong> {{ result.timestamp }}
  </div>
</div>
{% endfor %} {% if not results %}
<div class="card">
  <div class="alert alert-error">
    No analysis results found. Please run the analysis first.
  </div>
  <a href="/" class="btn">‚Üê Back to Dashboard</a>
</div>
{% endif %} {% endblock %}
